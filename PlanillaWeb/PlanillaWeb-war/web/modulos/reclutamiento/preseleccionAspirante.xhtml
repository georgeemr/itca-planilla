<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="/plantillas/defaultTemplate.xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.prime.com.tr/ui"
                xmlns:f="http://java.sun.com/jsf/core">

    <ui:define name="titulo">Preselecci&oacute;n de candidatos</ui:define>

    <ui:define name="acciones">
        <p:tab title="Acciones">
            <h:panelGrid columns="1">
                <p:commandLink styleClass="opcionMenu" action="#{reclutamiento$preseleccionAspirante.preseleccionarCandidato$action()}" update="mensajes" ajax="true">
                    <p:graphicImage value="/resources/iconos/dialog-ok-apply.png"/>
                    <h:outputText value="Preseleccionar" styleClass="espacioTexto"/>
                </p:commandLink>
            </h:panelGrid>
        </p:tab>  
    </ui:define>

    <ui:define name="contenido">      

        <p:fieldset legend="Concursos" >

            <h:outputText value="Seleccione la fecha inicial y final para iniciar la bÃºsqueda de concursos."/>
            <h:panelGrid columns="4">
                <h:outputLabel value=""/>
                <h:outputLabel value="Fecha inicial"/>
                <p:calendar id="calFechaInicial" 
                            pattern="dd/MM/yyyy" 
                            value="#{reclutamiento$preseleccionAspirante.fechaInicial}" 
                            showOn="button"/>
                <p:commandButton value="Buscar" 
                                 image="buscar" 
                                 update="mensajes, calFechaInicial, calFechaFinal, tablaConcursos, tablaCandidatos" 
                                 action="#{reclutamiento$preseleccionAspirante.buscarConcurso$action()}"/>
                <h:outputLabel value=""/>
                <h:outputLabel value="Fecha final"/>
                <p:calendar id="calFechaFinal" 
                            pattern="dd/MM/yyyy" 
                            value="#{reclutamiento$preseleccionAspirante.fechaFinal}" 
                            showOn="button" />
            </h:panelGrid>

            <p:dataTable id="tablaConcursos"
                         var="concurso" 
                         value="#{reclutamiento$preseleccionAspirante.listaConcurso}"
                         rows="5" 
                         paginator="true" 
                         emptyMessage="No se han encontrado concursos."
                         binding="#{reclutamiento$preseleccionAspirante.tableConcursos}"
                         paginatorAlwaysVisible="true" 
                         selection="#{SessionBeanREC.concursoSeleccionado}"
                         update="panelContenido"
                         selectionMode="single"
                         onRowSelectUpdate="panelContenido"
                         rowSelectListener="#{reclutamiento$preseleccionAspirante.onRowSelectConcurso}"
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" rowsPerPageTemplate="5,10,25,50,100" >
                <f:facet name="header">
                    <h:outputText value="Concursos"/>
                </f:facet>

                <p:column sortBy="#{concurso.concursoPK.codConcurso}">
                    <f:facet name="header">
                        C&oacute;digo
                    </f:facet>
                    <h:outputLabel value="#{concurso.concursoPK.codConcurso}"/>
                </p:column>

                <p:column filterBy="#{concurso.nombre}" 
                          filterMatchMode="contains"
                          headerText="Nombre del concurso">
                    <h:outputLabel value="#{concurso.nombre}"/>
                </p:column> 

                <p:column sortBy="#{concurso.fechaInicial}">
                    <f:facet name="header">
                        Fecha inicial
                    </f:facet>
                    <h:outputLabel value="#{concurso.fechaInicial}" >
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>
                </p:column>    

                <p:column sortBy="#{concurso.fechaFinal}">
                    <f:facet name="header">
                        Fecha final
                    </f:facet>
                    <h:outputLabel value="#{concurso.fechaFinal}" >
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>
                </p:column>         


                <p:column sortBy="#{concurso.numeroPlazas}">
                    <f:facet name="header">
                        N&uacute;mero de plazas
                    </f:facet>
                    <h:outputLabel value="#{concurso.numeroPlazas}" />
                </p:column> 

                <p:column sortBy="#{concurso.puesto.nombre}">
                    <f:facet name="header">
                        Puesto
                    </f:facet>
                    <h:outputLabel value="#{concurso.puesto.nombre}" />
                </p:column> 

                <p:column sortBy="#{concurso.estadoConcurso.nombre}">
                    <f:facet name="header">
                        Estado
                    </f:facet>
                    <h:outputLabel value="#{concurso.estadoConcurso.nombre}" />
                </p:column> 

            </p:dataTable>

            <p:spacer height="20" />

            <h:panelGrid columns="1">

                <h:outputLabel value="Criterios por puesto:" />
                <p:pickList id="picktCriterios" value="#{reclutamiento$preseleccionAspirante.listModelCriterios}" 
                            var="c" iconOnly="true" effect="bounce"
                            itemLabel="#{c.criterio1.nombre}"
                            itemValue="#{c.criterio1.criterioPK.pkAsString}"
                            >
                    <f:facet name="sourceCaption">Disponible</f:facet>  
                    <f:facet name="targetCaption">Seleccionado</f:facet>  
                </p:pickList>
                <p:commandButton value="Aplicar Criterios" />

            </h:panelGrid>

            <p:dataTable id="tablaCandidatos"
                         var="candidato" 
                         value="#{reclutamiento$preseleccionAspirante.listaCandidato}"
                         selection="#{reclutamiento$preseleccionAspirante.candidatosSeleccionados}"
                         rows="5"                          
                         paginator="true" 
                         binding="#{reclutamiento$preseleccionAspirante.tableCandidatos}"
                         emptyMessage="No se han encontrado candidatos."
                         paginatorAlwaysVisible="true"                         
                         paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" rowsPerPageTemplate="5,10,25,50,100" 
                         selectionMode="multiple">

                <f:facet name="header">
                    <h:outputText value="Candidatos"/>
                </f:facet>

                <p:column sortBy="#{candidato.candidatoPK.codCandidato}">
                    <f:facet name="header">
                        C&oacute;digo
                    </f:facet>
                    <h:outputLabel value="#{candidato.candidatoPK.codCandidato}"/>
                </p:column>

                <p:column filterBy="#{candidato.nombreCompleto}"
                          filterMatchMode="contains"
                          headerText="Nombre">
                    <h:outputLabel value="#{candidato.nombreCompleto}"/>
                </p:column> 
            </p:dataTable>

        </p:fieldset>

    </ui:define>

</ui:composition>