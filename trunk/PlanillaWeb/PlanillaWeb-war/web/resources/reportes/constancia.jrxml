<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="constancia" pageWidth="595" pageHeight="842" columnWidth="535" leftMargin="30" rightMargin="30" topMargin="20" bottomMargin="20">
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="35"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<parameter name="pCia" class="java.math.BigDecimal">
		<defaultValueExpression><![CDATA[new BigDecimal("0")]]></defaultValueExpression>
	</parameter>
	<parameter name="pEmp" class="java.math.BigDecimal">
		<defaultValueExpression><![CDATA[new BigDecimal("0")]]></defaultValueExpression>
	</parameter>
	<parameter name="pAnio" class="java.math.BigDecimal">
		<defaultValueExpression><![CDATA[new BigDecimal("0")]]></defaultValueExpression>
	</parameter>
	<parameter name="pMes" class="java.math.BigDecimal">
		<defaultValueExpression><![CDATA[new BigDecimal("0")]]></defaultValueExpression>
	</parameter>
	<parameter name="pNumPla" class="java.math.BigDecimal">
		<defaultValueExpression><![CDATA[new BigDecimal("0")]]></defaultValueExpression>
	</parameter>
	<parameter name="pCodPla" class="java.math.BigDecimal">
		<defaultValueExpression><![CDATA[new BigDecimal("0")]]></defaultValueExpression>
	</parameter>
	<parameter name="SUBREPORT_DIR" class="java.lang.String">
		<defaultValueExpression><![CDATA["./"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select
	d.nom_comercial,
	p.num_planilla,
	p.cod_tipopla,
	initcap(nombres||' '||apellidos) as nombre,
	to_char(trunc (a.fec_ingreso),'dd "de " fmmonth " de " yyyy') as fecha_ingreso,
	b.nom_puesto,
	c.nom_agencia,
	valorLetras(a.salario_base) as cantidad_letras,
	a.salario_base,
        	d.direc_empresa as direccion,
	to_char(trunc (sysdate),'dd "de " fmmonth " de " yyyy') as al_dia_de
from
	empleados a
inner join puestos b on b.cod_puesto=a.cod_puesto
inner join agencias c on a.cod_sucursal = c.cod_agencia
inner join cias d on a.cod_cia=d.cod_cia
inner join planilla p on a.cod_cia=p.cod_cia and a.cod_emp=p.cod_emp
where
		a.cod_cia = $P{pCia}
	and	a.cod_emp = $P{pEmp}
	and	p.anio = $P{pAnio}
	and	p.mes = $P{pMes}
	and	p.num_planilla = $P{pNumPla}
	and	p.cod_tipopla = $P{pCodPla}]]>
	</queryString>
	<field name="NOM_COMERCIAL" class="java.lang.String"/>
	<field name="NUM_PLANILLA" class="java.math.BigDecimal"/>
	<field name="COD_TIPOPLA" class="java.math.BigDecimal"/>
	<field name="NOMBRE" class="java.lang.String"/>
	<field name="FECHA_INGRESO" class="java.lang.String"/>
	<field name="NOM_PUESTO" class="java.lang.String"/>
	<field name="NOM_AGENCIA" class="java.lang.String"/>
	<field name="CANTIDAD_LETRAS" class="java.lang.String"/>
	<field name="SALARIO_BASE" class="java.math.BigDecimal"/>
	<field name="DIRECCION" class="java.lang.String"/>
	<field name="AL_DIA_DE" class="java.lang.String"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band splitType="Prevent"/>
	</title>
	<pageHeader>
		<band height="49" splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band splitType="Prevent"/>
	</columnHeader>
	<detail>
		<band height="360" splitType="Stretch">
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="0" y="3" width="535" height="137"/>
				<textElement textAlignment="Justified" lineSpacing="Double"/>
				<textFieldExpression class="java.lang.String"><![CDATA["El  Suscrito Subgerente Administrativo del (la) " + $F{NOM_COMERCIAL} + "HACE CONSTAR QUE: el Señor (a) (ita), " + $F{NOMBRE} +
" trabaja en la institución desde el " + $F{FECHA_INGRESO} + ". Actualmente desempeña el cargo de " + $F{NOM_PUESTO} +
" en la agencia " + $F{NOM_AGENCIA} + ", devengando un sueldo mensual de " + $F{CANTIDAD_LETRAS} + "(" + $F{SALARIO_BASE} + ")" + "\n\r" + "De su sueldo se hacen las deducciones siguientes:"]]></textFieldExpression>
			</textField>
			<subreport isUsingCache="true">
				<reportElement key="subreport-1" x="0" y="145" width="535" height="173"/>
				<subreportParameter name="pMes">
					<subreportParameterExpression><![CDATA[$P{pMes}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="pAnio">
					<subreportParameterExpression><![CDATA[$P{pAnio}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="pNumPla">
					<subreportParameterExpression><![CDATA[$P{pNumPla}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="pCia">
					<subreportParameterExpression><![CDATA[$P{pCia}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="pCodPla">
					<subreportParameterExpression><![CDATA[$P{pCodPla}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="pEmp">
					<subreportParameterExpression><![CDATA[$P{pEmp}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="tipo">
					<subreportParameterExpression><![CDATA["R"]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_DIR} + "constancia_detalle.jasper"]]></subreportExpression>
			</subreport>
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="0" y="323" width="535" height="35"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA["Y para los usos que el interesado estime convenientes, extiendo la presente en San Salvador al dia " + $F{AL_DIA_DE}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Prevent"/>
	</columnFooter>
	<pageFooter>
		<band height="35" splitType="Stretch">
			<textField>
				<reportElement x="0" y="10" width="535" height="25"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{DIRECCION}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band splitType="Prevent"/>
	</summary>
</jasperReport>
